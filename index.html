<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Black Box Demystified</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.2em;
        }
        
        .explainer {
            background: #fff3cd;
            border: 3px solid #ffc107;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .explainer h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        .explainer ul {
            margin: 15px 0 15px 25px;
            color: #333;
        }
        
        .explainer li {
            margin: 8px 0;
        }
        
        .explainer strong {
            color: #856404;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-end;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
            min-width: 300px;
        }
        
        label {
            font-weight: 600;
            color: #34495e;
            font-size: 1em;
        }
        
        select {
            padding: 12px 20px;
            border: 2px solid #3498db;
            border-radius: 8px;
            font-size: 1.1em;
            background: white;
            cursor: pointer;
            font-family: inherit;
        }
        
        button {
            padding: 12px 40px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        button:hover:not(:disabled) {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            display: none;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .step {
            background: #f8f9fa;
            border-left: 5px solid #95a5a6;
            padding: 25px;
            margin: 20px 0;
            border-radius: 8px;
            opacity: 0.3;
            transition: all 0.5s;
        }
        
        .step.active {
            opacity: 1;
            border-left-color: #3498db;
            background: #ebf5fb;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }
        
        .step h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .step-number {
            background: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .matrix-viz {
            background: white;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
        }
        
        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .result-box {
            background: #d4edda;
            border: 3px solid #28a745;
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
            text-align: center;
        }
        
        .result-box h3 {
            color: #155724;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .predicted-word {
            font-size: 2.2em;
            color: #28a745;
            font-weight: bold;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
        }
        
        .progress-bar {
            width: 100%;
            height: 35px;
            background: #ecf0f1;
            border-radius: 18px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid #bdc3c7;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîì Opening the "Black Box"</h1>
        <p class="subtitle">Understanding What Happens Inside an LLM</p>
        
        <div class="explainer">
            <h3>üìñ What This Demo Shows:</h3>
            <p><strong>This is NOT a full LLM.</strong> This is an educational demonstration designed to demystify the "black box" of how Large Language Models work.</p>
            
            <p style="margin-top: 15px;"><strong>What you'll see:</strong></p>
            <ul>
                <li><strong>Step 1:</strong> How text becomes numbers (embedding lookup)</li>
                <li><strong>Step 2:</strong> How those numbers flow through layers (matrix multiplications)</li>
                <li><strong>Step 3:</strong> How the model picks the next word (argmax over scores)</li>
            </ul>
            
            <p style="margin-top: 15px;"><strong>The Key Insight:</strong></p>
            <p style="margin-top: 8px;">ChatGPT, Claude, and all LLMs use these <em>exact same mathematical operations</em>. The only difference is <strong>scale</strong> ‚Äî billions of parameters instead of pre-defined patterns. But the process? Identical matrix operations.</p>
            
            <p style="margin-top: 15px; padding: 12px; background: #fef5e7; border-radius: 5px;"><strong>üí° There's no magic inside the black box ‚Äî just math!</strong></p>
        </div>
        
        <div class="controls">
            <div class="input-group">
                <label for="promptSelect">Choose a text prompt:</label>
                <select id="promptSelect">
                    <optgroup label="Geography - Countries">
                        <option value="The capital of France is">The capital of France is...</option>
                        <option value="The capital of England is">The capital of England is...</option>
                        <option value="The capital of Italy is">The capital of Italy is...</option>
                        <option value="The capital of Spain is">The capital of Spain is...</option>
                        <option value="The capital of Germany is">The capital of Germany is...</option>
                        <option value="The capital of Japan is">The capital of Japan is...</option>
                    </optgroup>
                    <optgroup label="Geography - US States">
                        <option value="The capital of California is">The capital of California is...</option>
                        <option value="The capital of Florida is">The capital of Florida is...</option>
                        <option value="The capital of Texas is">The capital of Texas is...</option>
                        <option value="The capital of New York is">The capital of New York is...</option>
                    </optgroup>
                    <optgroup label="Common Phrases">
                        <option value="The cat sat on the">The cat sat on the...</option>
                        <option value="Once upon a time there was a">Once upon a time there was a...</option>
                        <option value="I went to the store to buy">I went to the store to buy...</option>
                        <option value="The quick brown fox jumps over the">The quick brown fox jumps over the...</option>
                    </optgroup>
                    <optgroup label="Technology & AI">
                        <option value="Machine learning is a type of">Machine learning is a type of...</option>
                        <option value="A neural network consists of">A neural network consists of...</option>
                        <option value="Matrix multiplication is used to">Matrix multiplication is used to...</option>
                        <option value="Artificial intelligence can be used to">Artificial intelligence can be used to...</option>
                    </optgroup>
                    <optgroup label="Questions">
                        <option value="What is the meaning of">What is the meaning of...</option>
                        <option value="How does a computer">How does a computer...</option>
                        <option value="Where can I find">Where can I find...</option>
                        <option value="Why do we need to">Why do we need to...</option>
                    </optgroup>
                </select>
            </div>
            <button onclick="processPrompt()" id="processBtn">See Inside the Black Box ‚Üí</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progress">Ready</div>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p><strong>Processing through the layers...</strong></p>
            <p style="margin-top: 10px; color: #666;">Matrix multiplications in progress</p>
        </div>
        
        <div id="step1" class="step">
            <h2><span class="step-number">1</span>Embedding Lookup</h2>
            <p><strong>Converting words to numbers</strong></p>
            <div class="matrix-viz" id="embeddingResult"></div>
            <div class="info-box">
                <strong>What's happening:</strong> Each word is looked up in a table (matrix) where every word has a unique row of numbers. This is just a <strong>table lookup</strong> ‚Äî like looking up a phone number in a contact list.
            </div>
        </div>
        
        <div id="step2" class="step">
            <h2><span class="step-number">2</span>Matrix Multiplications Through Layers</h2>
            <p><strong>Processing through transformer layers</strong></p>
            <div class="matrix-viz" id="layerResult"></div>
            <div class="info-box">
                <strong>What's happening:</strong> The numbers flow through multiple layers where they get multiplied by learned weight matrices. This is <strong>linear algebra</strong> ‚Äî multiplying and adding numbers.<br><br>
                <strong>Real LLMs:</strong> GPT-2 has 12 layers, GPT-3 has 96 layers. Same operations, just repeated more times with different learned numbers.
            </div>
        </div>
        
        <div id="step3" class="step">
            <h2><span class="step-number">3</span>Output Projection & Selection</h2>
            <p><strong>Computing scores for all possible next words</strong></p>
            <div class="matrix-viz" id="outputResult"></div>
            <div class="info-box">
                <strong>What's happening:</strong> The final numbers get multiplied by one more matrix that has a column for every word in the vocabulary (50,000+ words). This gives a <strong>score for each possible next word</strong>. The word with the highest score wins!
            </div>
        </div>
        
        <div class="result-box" id="result" style="display: none;">
            <h3>üéØ Predicted Next Word</h3>
            <div class="predicted-word" id="predictedWord"></div>
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 20px; text-align: left;">
                <strong style="color: #856404;">üìö The Black Box Revealed:</strong>
                <p style="margin-top: 10px; color: #333;">
                    You just watched the complete process: Text ‚Üí Numbers ‚Üí Matrix Math ‚Üí Next Word
                </p>
                <p style="margin-top: 10px; color: #333;">
                    <strong>In real LLMs like ChatGPT:</strong> The exact same steps happen, but with <em>billions</em> of learned parameters doing the matrix multiplications. The "intelligence" comes from having the right numbers in those matrices, learned by seeing trillions of examples during training.
                </p>
            </div>
        </div>
    </div>
    
    <script>
        let isProcessing = false;
        
        // Curated predictions for each prompt
        const predictions = {
            'The capital of France is': 'Paris',
            'The capital of England is': 'London',
            'The capital of Italy is': 'Rome',
            'The capital of Spain is': 'Madrid',
            'The capital of Germany is': 'Berlin',
            'The capital of Japan is': 'Tokyo',
            'The capital of California is': 'Sacramento',
            'The capital of Florida is': 'Tallahassee',
            'The capital of Texas is': 'Austin',
            'The capital of New York is': 'Albany',
            'The cat sat on the': 'mat',
            'Once upon a time there was a': 'princess',
            'I went to the store to buy': 'milk',
            'The quick brown fox jumps over the': 'lazy',
            'Machine learning is a type of': 'artificial',
            'A neural network consists of': 'layers',
            'Matrix multiplication is used to': 'transform',
            'Artificial intelligence can be used to': 'solve',
            'What is the meaning of': 'life',
            'How does a computer': 'work',
            'Where can I find': 'information',
            'Why do we need to': 'learn'
        };
        
        async function processPrompt() {
            if (isProcessing) return;
            
            const selectedPrompt = document.getElementById('promptSelect').value;
            const prediction = predictions[selectedPrompt] || 'the';
            
            // Reset
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById('result').style.display = 'none';
            updateProgress(0, 'Processing...');
            
            document.getElementById('loading').classList.add('active');
            document.getElementById('processBtn').disabled = true;
            isProcessing = true;
            
            try {
                // Step 1: Embedding
                await activateStep(1, selectedPrompt);
                updateProgress(33, 'Step 1/3: Embedding Lookup');
                await sleep(1200);
                
                // Step 2: Layers
                await activateStep(2, selectedPrompt);
                updateProgress(66, 'Step 2/3: Layer Processing');
                await sleep(1400);
                
                // Step 3: Output
                await activateStep(3, selectedPrompt, prediction);
                updateProgress(90, 'Step 3/3: Computing Scores');
                await sleep(1200);
                
                updateProgress(100, 'Complete!');
                await sleep(400);
                
                showResult(selectedPrompt, prediction);
                
            } finally {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('processBtn').disabled = false;
                isProcessing = false;
            }
        }
        
        async function activateStep(stepNum, prompt, prediction) {
            const step = document.getElementById(`step${stepNum}`);
            step.classList.add('active');
            step.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            if (stepNum === 1) {
                const tokens = prompt.split(/\s+/);
                const tokenCount = tokens.length;
                const vector = Array.from({length: 8}, () => (Math.random() * 2 - 1).toFixed(3));
                
                document.getElementById('embeddingResult').innerHTML = `
                    <p style="margin-bottom: 12px;"><strong>Input text:</strong> "${prompt}"</p>
                    <p style="margin-bottom: 12px;"><strong>Step 1a - Tokenize:</strong> Split into ${tokenCount} tokens</p>
                    <p style="margin-bottom: 12px;"><strong>Step 1b - Lookup:</strong> Each token ‚Üí row in [50,257 √ó 768] embedding matrix</p>
                    <p style="margin-top: 15px; padding: 10px; background: #f0f0f0; border-radius: 5px;">
                        <strong>Example:</strong> Token "${tokens[tokens.length - 1]}" ‚Üí <code>[${vector.join(', ')}, ..., 0.891]</code><br>
                        <span style="color: #666; font-size: 0.9em;">(768 numbers total)</span>
                    </p>
                    <p style="margin-top: 12px; color: #666; font-size: 0.95em;">
                        <strong>Result:</strong> We now have ${tokenCount} vectors, each with 768 numbers
                    </p>
                `;
            } else if (stepNum === 2) {
                const layerOps = [
                    'Self-Attention: Computing which words attend to which',
                    'Feed-Forward: [768] √ó [768√ó3072] √ó [3072√ó768]',
                    'Add & Normalize: Stabilizing the values'
                ];
                
                document.getElementById('layerResult').innerHTML = `
                    <p style="margin-bottom: 15px;"><strong>Processing through transformer layers...</strong></p>
                    <div style="background: #f0f0f0; padding: 12px; border-radius: 5px; margin: 10px 0;">
                        <strong>Layer 1:</strong><br>
                        ${layerOps.map(op => `‚Ä¢ ${op}`).join('<br>')}
                    </div>
                    <p style="text-align: center; font-size: 1.2em; margin: 15px 0;">‚¨áÔ∏è</p>
                    <div style="background: #f0f0f0; padding: 12px; border-radius: 5px; margin: 10px 0;">
                        <strong>Layer 2:</strong><br>
                        <em>Same operations, different learned weights...</em>
                    </div>
                    <p style="text-align: center; font-size: 1.2em; margin: 15px 0;">‚¨áÔ∏è</p>
                    <p style="text-align: center; color: #666;">
                        ... repeat through all layers ...<br>
                        <small>(GPT-2: 12 layers, GPT-3: 96 layers)</small>
                    </p>
                    <p style="margin-top: 15px; padding: 10px; background: #e8f4f8; border-radius: 5px;">
                        <strong>Key Point:</strong> Each layer performs <em>millions of matrix multiplications</em>. All just multiplying and adding numbers!
                    </p>
                `;
            } else if (stepNum === 3) {
                const scores = Array.from({length: 5}, () => (Math.random() * 15 - 3).toFixed(2));
                
                document.getElementById('outputResult').innerHTML = `
                    <p style="margin-bottom: 15px;"><strong>Final matrix multiplication:</strong></p>
                    <p style="margin-bottom: 10px; font-family: monospace; background: #f0f0f0; padding: 10px; border-radius: 5px;">
                        [1 √ó 768] √ó [768 √ó 50,257] = [1 √ó 50,257]
                    </p>
                    <p style="margin: 15px 0;"><strong>This produces a score for EVERY word in the vocabulary:</strong></p>
                    <div style="background: #f0f0f0; padding: 12px; border-radius: 5px; margin: 10px 0;">
                        <table style="width: 100%; text-align: left;">
                            <tr style="border-bottom: 2px solid #ddd;">
                                <th style="padding: 8px;">Word</th>
                                <th style="padding: 8px;">Score</th>
                            </tr>
                            <tr>
                                <td style="padding: 8px;"><strong style="color: #28a745;">${prediction}</strong></td>
                                <td style="padding: 8px;"><strong style="color: #28a745;">12.47 ‚Üê HIGHEST!</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px;">the</td>
                                <td style="padding: 8px;">${scores[0]}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px;">a</td>
                                <td style="padding: 8px;">${scores[1]}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px;">and</td>
                                <td style="padding: 8px;">${scores[2]}</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px;">...</td>
                                <td style="padding: 8px;">...</td>
                            </tr>
                        </table>
                    </div>
                    <p style="margin-top: 15px; padding: 10px; background: #e8f4f8; border-radius: 5px;">
                        <strong>Selection:</strong> Pick the word with the highest score ‚Üí <strong>${prediction}</strong>
                    </p>
                `;
            }
        }
        
        function showResult(prompt, prediction) {
            document.getElementById('predictedWord').innerHTML = `
                "${prompt} <strong style="color: #28a745;">${prediction}</strong>"
            `;
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function updateProgress(percent, text) {
            const progressBar = document.getElementById('progress');
            progressBar.style.width = percent + '%';
            progressBar.textContent = text || (Math.round(percent) + '%');
        }
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // Auto-run first example on load
        setTimeout(() => processPrompt(), 1000);
    </script>
</body>
</html>
